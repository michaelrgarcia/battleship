(()=>{"use strict";function t(t,n){const[e,o]=t,i=n.querySelectorAll(".coordinate");let s;for(let t=0;t<i.length;t+=1)if(s=i[t],Number(s.dataset.x)===e&&Number(s.dataset.y)===o)return s;return null}function n(n,e){const o=[];for(let i=0;i<n.length;i+=1){const s=t(n[i],e);s&&o.push(s)}return o}function e(t,e){const o=n(t.getMissedAttacks(),e);for(let t=0;t<o.length;t+=1)o[t].classList.add("miss")}function o(t,e){const o=n(t.getSuccessfulAttacks(),e);for(let t=0;t<o.length;t+=1)o[t].classList.add("hit")}function i(n,i){const s=function(n,e){const o=[];for(let i=0;i<n.length;i+=1){const s=n[i];if(s.length>2){const n=t(s,e);n&&o.push(n)}}return o}(n.getBoard(),i);for(let t=0;t<s.length;t+=1)s[t].classList.add("placed-ship");e(n,i),o(n,i)}function s(t,n){const e=n;t.style.display="block",e.style.display="grid"}function r(t,n){const e=n;t.style.display="none",e.style.display="none"}function c(t){const n=t.querySelectorAll(".coordinate");for(let t=0;t<n.length;t+=1){const e=n[t],o=e.classList;(o.contains("placed-ship")||o.contains("hit")||o.contains("miss"))&&e.classList.remove("placed-ship","hit","miss")}}const l=document.querySelector(".player-board"),a=document.querySelector(".cpu-board"),d=document.querySelector("p:nth-child(2)"),u=document.querySelector("p:nth-child(4)"),f=document.getElementById("next"),y=document.getElementById("play-again"),h=document.querySelector(".game-info");function g(){a.setAttribute("aria-disabled","false")}function p(t){h.textContent=t?"Hit!":"Miss."}function m(t,n){const e=t.allShipsSunk(),o=n.allShipsSunk();(e||o)&&(f.style.display="none",y.style.display="block",h.textContent=e?"All computer ships sank. Game over!":"All of your ships sank. Game over!")}function S(t){s(u,a),r(d,l),o(t,a),e(t,a),g(),f.disabled=!0,h.textContent="Take your shot."}function b(t,n){a.addEventListener("click",(i=>{if("false"===a.ariaDisabled){const s=i.target;if(s.classList.contains("hit")||s.classList.contains("miss"))h.textContent="Please choose another coordinate.";else{const{x:i,y:r}=s.dataset,c=t.receiveAttack([Number(i),Number(r)]);o(t,a),e(t,a),p(c),a.setAttribute("aria-disabled","true"),f.disabled=!1,m(t,n)}}}))}function k(t,n){s(d,l),r(u,a),i(n,l),f.disabled=!0,h.textContent="CPU is taking a shot...",setTimeout((()=>{!function(t,n){const e=t.randomShot(n);i(n,l),p(e),g(),f.disabled=!1}(t,n)}),1500),m(t.board,n)}function B(t,n){return Math.floor(Math.random()*(n-t+1)+t)}function N(t,n){const e=B(1,10),o=B(1,10-t);if(n.find((t=>JSON.stringify(t)===JSON.stringify([o,e])))){const i=[];for(let s=0;s<t;s+=1){const r=o+s;if(!n.find((t=>JSON.stringify(t)===JSON.stringify([r,e]))))return N(t,n);i.push([r,e])}return i}return N(t,n)}function J(t,n){const e=B(1,10),o=B(1,10-t);if(n.find((t=>JSON.stringify(t)===JSON.stringify([e,o])))){const i=[];for(let s=0;s<t;s+=1){const r=o+s;if(!n.find((t=>JSON.stringify(t)===JSON.stringify([e,r]))))return J(t,n);i.push([e,r])}return i}return J(t,n)}function O(t,n){if(0===B(0,1)){const e=N(t,n.getBoard());n.placeShip(e)}else{const e=J(t,n.getBoard());n.placeShip(e)}}function A(){const t=function(){const t=[[1,1],[2,1],[3,1],[4,1],[5,1],[6,1],[7,1],[8,1],[9,1],[10,1],[1,2],[2,2],[3,2],[4,2],[5,2],[6,2],[7,2],[8,2],[9,2],[10,2],[1,3],[2,3],[3,3],[4,3],[5,3],[6,3],[7,3],[8,3],[9,3],[10,3],[1,4],[2,4],[3,4],[4,4],[5,4],[6,4],[7,4],[8,4],[9,4],[10,4],[1,5],[2,5],[3,5],[4,5],[5,5],[6,5],[7,5],[8,5],[9,5],[10,5],[1,6],[2,6],[3,6],[4,6],[5,6],[6,6],[7,6],[8,6],[9,6],[10,6],[1,7],[2,7],[3,7],[4,7],[5,7],[6,7],[7,7],[8,7],[9,7],[10,7],[1,8],[2,8],[3,8],[4,8],[5,8],[6,8],[7,8],[8,8],[9,8],[10,8],[1,9],[2,9],[3,9],[4,9],[5,9],[6,9],[7,9],[8,9],[9,9],[10,9],[1,10],[2,10],[3,10],[4,10],[5,10],[6,10],[7,10],[8,10],[9,10],[10,10]],n=[],e=[];return{placeShip:function(n){const e=n.length,o=function(t){const n=t;let e=0;return{hit:function(){return e+=1,e},isSunk:function(){return n===e}}}(e);for(let i=0;i<e;i+=1){const e=n[i],s=t.find((t=>JSON.stringify(t)===JSON.stringify(e)));s&&s.length<3&&s.push(o)}return t},receiveAttack:function(o){let i;for(let s=0;s<t.length;s+=1){const r=t[s],c=r.filter((t=>"number"==typeof t));JSON.stringify(o)===JSON.stringify(c)&&r.length>2&&!e.includes(c)&&!n.includes(c)&&(i=o,r[2].hit())}return i?e.push(o):n.push(o),i},allShipsSunk:function(){for(let n=0;n<t.length;n+=1){const e=t[n];if(e.length>2&&!1===e[2].isSunk())return!1}return!0},getBoard:function(){return t},getMissedAttacks:function(){return n},getSuccessfulAttacks:function(){return e},clearBoard:function(){for(let n=0;n<t.length;n+=1){const e=t[n];e.length>2&&e.pop()}}}}();return{board:t,randomizeBoard:function(){for(let n=0;n<10;n+=1)O(0===n?4:n<3?3:n<6?2:1,t)}}}function q(){const{board:t,randomizeBoard:n}=A();return{board:t,randomizeBoard:n}}function L(){const{board:t,randomizeBoard:n}=A();return{board:t,randomShot:function t(n){const e=B(1,10),o=B(1,10),i=n.getMissedAttacks(),s=n.getSuccessfulAttacks();return i.find((t=>JSON.stringify(t)===JSON.stringify([e,o])))||s.find((t=>JSON.stringify(t)===JSON.stringify([e,o])))?t(n):n.receiveAttack([e,o])},randomizeBoard:n}}function v(t,n,e){n.randomizeBoard(),t.randomizeBoard(),i(t.board,e)}!function(){const t=document.querySelector(".player-board"),n=document.querySelector(".cpu-board"),e=document.querySelector("p:nth-child(2)"),o=document.querySelector("p:nth-child(4)"),l=document.querySelector(".game-info"),a=document.getElementById("shuffle"),d=document.getElementById("go"),u=document.getElementById("next"),f=document.getElementById("play-again");let y=q(),h=L();v(y,h,t),a.addEventListener("click",(()=>{y.board.clearBoard(),c(t),y.randomizeBoard(),i(y.board,t)})),d.addEventListener("click",(()=>{s(o,n),r(e,t),a.style.display="none",d.style.display="none",u.style.display="block",S(h.board)})),b(h.board,y.board),u.addEventListener("click",(()=>{"false"===n.ariaDisabled?S(h.board):k(h,y.board)})),f.addEventListener("click",(()=>{r(e,t),r(o,n),c(t),c(n),y=q(),h=L(),v(y,h,t),s(e,t),f.style.display="none",a.style.display="block",d.style.display="block",l.textContent="Click the shuffle button to place the ships to your liking."}))}()})();