(()=>{"use strict";function t(t,e){const[n,o]=t,r=e.querySelectorAll(".coordinate");let c;for(let t=0;t<r.length;t+=1)if(c=r[t],Number(c.dataset.x)===n&&Number(c.dataset.y)===o)return c;return null}function e(e,n){const o=[];for(let r=0;r<e.length;r+=1){const c=t(e[r],n);c&&o.push(c)}return o}function n(t,n){const o=e(t.getMissedAttacks(),n);for(let t=0;t<o.length;t+=1)o[t].classList.add("miss")}function o(t,n){const o=e(t.getSuccessfulAttacks(),n);for(let t=0;t<o.length;t+=1)o[t].classList.add("hit")}function r(e,r){const c=function(e,n){const o=[];for(let r=0;r<e.length;r+=1){const c=e[r];if(c.length>2){const e=t(c,n);e&&o.push(e)}}return o}(e.getBoard(),r);for(let t=0;t<c.length;t+=1)c[t].classList.add("placed-ship");n(e,r),o(e,r)}function c(t,e){const n=e;t.style.display="block",n.style.display="grid"}function s(t,e){const n=e;t.style.display="none",n.style.display="none"}const i=document.querySelector(".player-board"),l=document.querySelector(".cpu-board"),u=document.querySelector("p:nth-child(2)"),a=document.querySelector("p:nth-child(4)"),d=document.getElementById("next"),f=document.getElementById("play-again"),h=document.querySelector(".game-info");function y(){l.setAttribute("aria-disabled","false")}function p(t){h.textContent=t?"Hit!":"Miss."}function b(t,e){const n=t.allShipsSunk(),o=e.allShipsSunk();(n||o)&&(d.style.display="none",f.style.display="block",h.textContent=n?"All computer ships sank. Game over!":"All of your ships sank. Game over!")}function g(t){c(a,l),s(u,i),o(t,l),n(t,l),y(),d.disabled=!0,h.textContent="Take your shot."}function m(){return{board:function(){const t=[[1,1],[2,1],[3,1],[4,1],[5,1],[6,1],[7,1],[8,1],[9,1],[10,1],[1,2],[2,2],[3,2],[4,2],[5,2],[6,2],[7,2],[8,2],[9,2],[10,2],[1,3],[2,3],[3,3],[4,3],[5,3],[6,3],[7,3],[8,3],[9,3],[10,3],[1,4],[2,4],[3,4],[4,4],[5,4],[6,4],[7,4],[8,4],[9,4],[10,4],[1,5],[2,5],[3,5],[4,5],[5,5],[6,5],[7,5],[8,5],[9,5],[10,5],[1,6],[2,6],[3,6],[4,6],[5,6],[6,6],[7,6],[8,6],[9,6],[10,6],[1,7],[2,7],[3,7],[4,7],[5,7],[6,7],[7,7],[8,7],[9,7],[10,7],[1,8],[2,8],[3,8],[4,8],[5,8],[6,8],[7,8],[8,8],[9,8],[10,8],[1,9],[2,9],[3,9],[4,9],[5,9],[6,9],[7,9],[8,9],[9,9],[10,9],[1,10],[2,10],[3,10],[4,10],[5,10],[6,10],[7,10],[8,10],[9,10],[10,10]],e=[],n=[];return{placeShip:function(e){const n=e.length,o=function(t){const e=t;let n=0;return{hit:function(){return n+=1,n},isSunk:function(){return e===n}}}(n);for(let r=0;r<n;r+=1){const n=e[r],c=t.find((t=>JSON.stringify(t)===JSON.stringify(n)));c.length<3&&c.push(o)}return t},receiveAttack:function(o){let r;for(let c=0;c<t.length;c+=1){const s=t[c],i=s.filter((t=>"number"==typeof t));JSON.stringify(o)===JSON.stringify(i)&&s.length>2&&!n.includes(i)&&!e.includes(i)&&(r=o,s[2].hit())}return r?n.push(o):e.push(o),r},allShipsSunk:function(){for(let e=0;e<t.length;e+=1){const n=t[e];if(n.length>2&&!1===n[2].isSunk())return!1}return!0},getBoard:function(){return t},getMissedAttacks:function(){return e},getSuccessfulAttacks:function(){return n}}}()}}function S(t,e){return Math.floor(Math.random()*(e-t+1)+t)}const k=function(){const{board:t}=m();return{board:t}}(),A=document.querySelector(".player-board"),q=document.getElementById("shuffle"),v=document.getElementById("go"),E=document.getElementById("next");k.board.placeShip([[2,2],[2,3],[2,4]]),k.board.placeShip([[2,7],[3,7],[4,7],[5,7]]),r(k.board,A);const x=function(){const{board:t}=m();return{board:t,randomShot:function(t){const e=S(1,10),n=S(1,10);return t.receiveAttack([e,n])}}}(),N=document.querySelector(".cpu-board");var B,L;x.board.placeShip([[9,3],[9,4],[9,5]]),x.board.placeShip([[3,10],[4,10],[5,10]]),q.addEventListener("click",(()=>{})),B=x.board,L=k.board,l.addEventListener("click",(t=>{if("false"===l.ariaDisabled){const e=t.target,{x:r,y:c}=e.dataset,s=B.receiveAttack([Number(r),Number(c)]);o(B,l),n(B,l),p(s),l.setAttribute("aria-disabled","true"),d.disabled=!1,b(B,L)}})),v.addEventListener("click",(()=>{const t=document.querySelector("p:nth-child(2)");c(document.querySelector("p:nth-child(4)"),N),s(t,A),q.style.display="none",v.style.display="none",E.style.display="block",g(x.board)})),E.addEventListener("click",(()=>{"false"===N.ariaDisabled?g(x.board):function(t,e){c(u,i),s(a,l),r(e,i),d.disabled=!0,h.textContent="CPU is taking a shot...",setTimeout((()=>{!function(t,e){const n=t.randomShot(e);r(e,i),p(n),y(),d.disabled=!1}(t,e)}),1500),b(t.board,e)}(x,k.board)}))})();